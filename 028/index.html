<script>
// http://projecteuler.net/problem=28

Array.prototype.filterIndex = function(cb) {
	var self = this.valueOf(),
		res = [];
	for (var i = 0; i < self.length; i++) {
		if (cb && cb(i, self)) res.push(self[i]);
	}
	return res;
}

function range(first, last) {
	var r = [];
	for (var i = 0; i < last - first + 1; i++) {
		r.push(first + i);
	}
	return r;
}

var n = 1001,

	i = 1,
	last = 1,
	turn,
	
	sum = 1;

// optimization is obvious, but I like it the 'clear' way

while (last < Math.pow(n, 2)) {
	turn = range(last + 1, last + 8*i);

	sum += turn.filterIndex(function(i, arr) {
		return (i + 1) % (arr.length / 4) == 0;
	}).reduce(function(p, c) {
		return p + c;
	});
	
	last = turn[turn.length - 1];
	i++;
}

console.log(sum);
</script>